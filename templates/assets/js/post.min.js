(()=>{var __webpack_modules__={"./src/js/post.js":()=>{eval("let postContextInitial = false\nconst postContext = {\n  /* 初始化代码块 */\n  initCodeBlock() {\n    const $code = $('*:not(figure) > pre > code')\n    if ($code.length === 0) return\n    $code.each(function (index) {\n      const $pre = $(this).parent()\n      let clazz = $(this).attr('class')\n      // 通过class初始化代码块标题和是否默认关闭\n      let title = ''\n      let lines = false\n      let isClose = false\n      if (clazz != null) {\n        let str1 = clazz.match(/[|<](.*)$/)\n        let str2 = clazz.match(/:select/)\n        if (str1 || str2) {\n          let num = 0\n          if (str2) {\n            num = str2.index\n            if (str1) {\n              if (str1[1].endsWith(str2[0])) {\n                str1[1] = str1[1].substring(0, str1[1].length - str2[0].length)\n              }\n            } else {\n              title = clazz.substring(9, str2.index)\n            }\n            lines = true\n          }\n          if (str1) {\n            num = str1.index < num ? str1.index : num\n            if (str1[0][0] === '<') {\n              isClose = true\n            }\n            title = str1[1]\n          }\n          $(this).attr('class', clazz.substring(0, num))\n          if (!title) title = clazz.substring(9, num)\n        } else {\n          title = clazz.substring(9)\n        }\n      }\n      // 生成行号\n      let codes = $(this).text().split('\\n') || []\n      let nums = codes.length - 1\n      let lineDigit = String(nums).length\n      if (lineDigit === 1) lineDigit = 2\n      let lis = ''\n      for (var i = 0; i < nums; i++) {\n        lis += `<li ${(lines && /^\\s*\\|\\+\\s+/.test(codes[i]))? 'class=\"code-select\"' : ''}>${String(i + 1).padStart(lineDigit, 0)}</li>`\n      }\n      if (lines) {\n        $(this).text($(this).text().replace(/(^\\s*)\\|\\+\\s/gm,'$1'))\n      }\n      // 代码块的id，用于代码块复制和折叠\n      let id = `codeBlock${index}-${new Date().getTime()}`\n      let close = ''\n      if (isClose) {\n        close = ' close'\n        $(this).parent().hide()\n      }\n      // 生成标题栏的按钮\n      let titleButton = `<div><i class=\"ri-arrow-down-s-line${close}\" data-code='#${id}'></i><i class=\"ri-file-copy-2-line btn-clipboard\" title=\"复制代码\" data-clipboard-target='#${id}'></i></div>`\n\n      // 组装代码块\n      $(this).attr('id', id)\n      $pre.prepend(`<ul>${lis}</ul>`)\n      if (nums > themeConfig.code_fold_line) {\n        $pre.wrap('<figure class=\"fold hljs\"></figure>').append('<div class=\"expand-done\"><i class=\"ri-arrow-up-double-line\"></i></div>')\n      } else {\n        $pre.wrap('<figure class=\"hljs\"></figure>')\n      }\n      $pre.parent().prepend(`<figcaption>${title}${titleButton}</figcaption>`)\n    })\n    console.log('$initCodeBlock end')\n  },\n  /* 初始化文艺模式 */\n  // initLiterature() {\n  //   $('.literature-content>p:not([class]),.literature-content>mew-hide>p:not([class])').each(function () {\n  //     if ($(this).children(':not(code,a,strong,em,ins,b,s,br,span.pwd)').length === 0) {\n  //       $(this).addClass('note')\n  //     }\n  //   })\n  // },\n  /* 初始化喜欢功能 */\n  /* 点赞 */\n  // initLike() {\n  //   Utils.initLikeButton('.admire .agree.like', 'posts')\n  // },\n  /* 代码块高亮 */\n  initHighlighting() {\n    // 初始化代码块高亮工具\n    hljs.initHighlightingOnLoad()\n  },\n  /**\n     * 初始化分享\n     */\n  initShare() {\n    if (!window.DShare) return\n    let imageUrl = $('.cover-image').css('background-image')\n    imageUrl && (imageUrl = imageUrl.substring(5, imageUrl.length - 2))\n    DShare.create('.dshare', {image: imageUrl, imageSelector: '.main-content'})\n  },\n  /* 代码块复制 */\n  initClipboard() {\n    if (window.clipboard) {\n      return\n    }\n    // 初始化代码块复制插件，一个界面仅需初始化一次\n    window.clipboard = new ClipboardJS('.btn-clipboard')\n    clipboard.on('error', function (e) {\n      e.clearSelection()\n      Qmsg.error('您的浏览器不支持复制')\n    })\n    clipboard.on('success', function () {\n      Qmsg.success('复制成功')\n    })\n  },\n  /* 初始化图片折叠 */\n  foldImage() {\n    if (!themeConfig.img_fold_height) return\n    const $galleryList = $('.article .gallery-item>[data-fancybox]>img')\n    $galleryList.parent().addClass('fold')\n    $galleryList.each(function () {\n      const $gallery = $(this).parent()\n      if (this.complete) {\n        if (this.scrollHeight >= themeConfig.img_fold_height) {\n          $gallery.append('<div class=\"expand-done\"><i class=\"ri-arrow-up-double-line\"></i></div>')\n        } else {\n          $gallery.removeClass('fold')\n        }\n      } else {\n        this.onload = function () {\n          if (this.scrollHeight >= themeConfig.img_fold_height) {\n            $gallery.append('<div class=\"expand-done\"><i class=\"ri-arrow-up-double-line\"></i></div>')\n          } else {\n            $gallery.removeClass('fold')\n          }\n        }\n      }\n    })\n  },\n  /* 初始化事件 */\n  initEvent() {\n    if (postContextInitial) return\n    let $body = $('body')\n    // 代码块展开和关闭点击事件\n    $body.on('click', 'figure>figcaption .ri-arrow-down-s-line', function () {\n      let $this = $(this)\n      if ($this.is('.close')) {\n        $($this.attr('data-code')).parent().slideDown(200)\n        $this.removeClass('close')\n      } else {\n        $($this.attr('data-code')).parent().slideUp(200)\n        $this.addClass('close')\n      }\n    })\n    // 代码内容块展开和折叠点击事件\n    $body.on('click', 'figure > pre > .expand-done', function () {\n      Utils.foldBlock($(this).parent().parent())\n    })\n    // 图片的展开和折叠事件\n    $body.on('click', '.gallery-item .expand-done', function (e) {\n      e.stopPropagation()\n      Utils.foldBlock($(this).parent())\n    })\n    // 喜欢\n    // Utils.initLikeEvent('.admire .agree.like', 'posts', ($elem) => $elem.find('span').find('span'))\n    // 隐藏内容\n    window.onCommentSuccessEvent = (comment, target) => {\n      let name = encrypt('mew-hide-' + target)\n      let commentIds = localStorage.getItem(name)\n      commentIds = commentIds ? JSON.parse(decrypt(commentIds)) : []\n      let id = String(comment.postId)\n      if (commentIds.includes(id)) {\n        return\n      }\n      commentIds.push(id)\n      $(`.main-content[data-target='${target}'][data-id='${id}'] mew-hide[hide]`)\n        .each(function () {\n          $(this).before(decrypt(this.getAttribute('hide')))\n          $(this).remove()\n          commonContext.initGallery()\n          postContext.initCodeBlock()\n          postContext.initLiterature()\n          postContext.initHighlighting()\n          if (this.getAttribute('toc') === 'true') commonContext.initTocAndNotice()\n        })\n      localStorage.setItem(name, encrypt(JSON.stringify(commentIds)))\n    }\n    postContextInitial = true\n  }\n  /* 初始化公式 */\n  // initKatex() {\n  //   let $mainContent = $('.main-content')\n  //   if (!window.katex && $mainContent.length !== 0) {\n  //     return\n  //   }\n  //   $mainContent.find('.katex--inline').each(function (index, domEle) {\n  //     katex.render(domEle.innerText, domEle, { displayMode: false })\n  //   })\n  //   $mainContent.find('.katex--display').each(function (index, domEle) {\n  //     katex.render(domEle.innerText, domEle, { displayMode: true })\n  //   })\n  // }\n}\nwindow.postPjax = function (serialNumber) {\n  if ($('.main-content').length === 0) return\n  Object.keys(postContext).forEach(\n    (c) => window.pjaxSerialNumber === serialNumber && postContext[c]()\n  )\n}\n!(function () {\n  // const advances = ['initEvent', 'initCodeBlock', 'initLiterature', 'initLike', 'foldImage']\n  const advances = []\n  Object.keys(postContext).forEach(\n    (c) => !window.pjaxSerialNumber && advances.includes(c) && postContext[c]()\n  )\n\n  document.addEventListener('DOMContentLoaded', function () {\n    Object.keys(postContext).forEach(\n      (c) => !window.pjaxSerialNumber && !advances.includes(c) && postContext[c]()\n    )\n  })\n})()\n\n\n//# sourceURL=webpack://as-rust-blog-theme1.0/./src/js/post.js?")}},__webpack_exports__={};__webpack_modules__["./src/js/post.js"]()})();